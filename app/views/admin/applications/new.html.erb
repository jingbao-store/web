<% content_for :title, "New Application" %>

<div class="container-md">
  <div class="flex items-center space-x-4">
    <%= link_to admin_applications_path, class: "btn-ghost text-sm py-1 px-3" do %>
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Back to Applications
    <% end %>
  </div>

  <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-50 mt-4 mb-8">Create New Application</h1>

  <!-- Form -->
  <div class="card bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700">
    <div class="card-body">
      <%= form_with model: [:admin, @application], local: true, class: "space-y-6" do |form| %>
        <%= render 'shared/form_error_message', model: @application %>

        <!-- Name -->
        <div class="mb-4">
          <%= form.label :name, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Name<% if field_required?(@application, :name) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :name, {
            placeholder: "Enter name...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :name) ? { required: true } : {}) %>
          <% if @application.errors[:name].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:name].first %></p>
          <% end %>
        </div>

        <!-- Package name -->
        <div class="mb-4">
          <%= form.label :package_name, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Package name<% if field_required?(@application, :package_name) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :package_name, {
            placeholder: "Enter package name...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :package_name) ? { required: true } : {}) %>
          <% if @application.errors[:package_name].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:package_name].first %></p>
          <% end %>
        </div>

        <!-- Version -->
        <div class="mb-4">
          <%= form.label :version, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Version<% if field_required?(@application, :version) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :version, {
            placeholder: "Enter version...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :version) ? { required: true } : {}) %>
          <% if @application.errors[:version].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:version].first %></p>
          <% end %>
        </div>

        <!-- Description -->
        <div class="mb-4">
          <%= form.label :description, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Description<% if field_required?(@application, :description) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_area :description, {
            rows: 5,
            placeholder: "Enter description...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :description) ? { required: true } : {}) %>
          <% if @application.errors[:description].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:description].first %></p>
          <% end %>
        </div>

        <!-- Icon -->
        <div class="mb-4">
          <%= form.label :icon, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Icon<% if field_required?(@application, :icon) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :icon, {
            placeholder: "Enter icon...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :icon) ? { required: true } : {}) %>
          <% if @application.errors[:icon].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:icon].first %></p>
          <% end %>
        </div>

        <!-- Download url -->
        <div class="mb-4">
          <%= form.label :download_url, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Download url<% if field_required?(@application, :download_url) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :download_url, {
            placeholder: "Enter download url...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :download_url) ? { required: true } : {}) %>
          <% if @application.errors[:download_url].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:download_url].first %></p>
          <% end %>
        </div>

        <!-- File size -->
        <div class="mb-4">
          <%= form.label :file_size, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            File size<% if field_required?(@application, :file_size) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :file_size, {
            placeholder: "Enter file size...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :file_size) ? { required: true } : {}) %>
          <% if @application.errors[:file_size].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:file_size].first %></p>
          <% end %>
        </div>

        <!-- File size bytes -->
        <div class="mb-4">
          <%= form.label :file_size_bytes, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            File size bytes<% if field_required?(@application, :file_size_bytes) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.number_field :file_size_bytes, {
            placeholder: "Enter file size bytes...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :file_size_bytes) ? { required: true } : {}) %>
          <% if @application.errors[:file_size_bytes].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:file_size_bytes].first %></p>
          <% end %>
        </div>

        <!-- Developer -->
        <div class="mb-4">
          <%= form.label :developer, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Developer<% if field_required?(@application, :developer) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :developer, {
            placeholder: "Enter developer...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :developer) ? { required: true } : {}) %>
          <% if @application.errors[:developer].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:developer].first %></p>
          <% end %>
        </div>

        <!-- Rating -->
        <div class="mb-4">
          <%= form.label :rating, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Rating<% if field_required?(@application, :rating) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.number_field :rating, {
            placeholder: "Enter rating...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :rating) ? { required: true } : {}) %>
          <% if @application.errors[:rating].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:rating].first %></p>
          <% end %>
        </div>

        <!-- Downloads -->
        <div class="mb-4">
          <%= form.label :downloads, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Downloads<% if field_required?(@application, :downloads) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.number_field :downloads, {
            placeholder: "Enter downloads...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :downloads) ? { required: true } : {}) %>
          <% if @application.errors[:downloads].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:downloads].first %></p>
          <% end %>
        </div>

        <!-- Last updated -->
        <div class="mb-4">
          <%= form.label :last_updated, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Last updated<% if field_required?(@application, :last_updated) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.date_field :last_updated, {
            placeholder: "Enter last updated...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :last_updated) ? { required: true } : {}) %>
          <% if @application.errors[:last_updated].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:last_updated].first %></p>
          <% end %>
        </div>

        <!-- Min android version -->
        <div class="mb-4">
          <%= form.label :min_android_version, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Min android version<% if field_required?(@application, :min_android_version) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_field :min_android_version, {
            placeholder: "Enter min android version...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :min_android_version) ? { required: true } : {}) %>
          <% if @application.errors[:min_android_version].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:min_android_version].first %></p>
          <% end %>
        </div>

        <!-- Permissions -->
        <div class="mb-4">
          <%= form.label :permissions, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Permissions<% if field_required?(@application, :permissions) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_area :permissions, {
            rows: 5,
            placeholder: "Enter permissions...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :permissions) ? { required: true } : {}) %>
          <% if @application.errors[:permissions].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:permissions].first %></p>
          <% end %>
        </div>

        <!-- Features -->
        <div class="mb-4">
          <%= form.label :features, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Features<% if field_required?(@application, :features) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.text_area :features, {
            rows: 5,
            placeholder: "Enter features...",
            class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50"
          }.merge(field_required?(@application, :features) ? { required: true } : {}) %>
          <% if @application.errors[:features].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:features].first %></p>
          <% end %>
        </div>

        <!-- Category -->
        <div class="mb-4">
          <%= form.label :category_id, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" do %>
            Category<% if field_required?(@application, :category) %> <span class="text-red-500">*</span><% end %>
          <% end %>
          <%= form.select :category_id, 
              options_for_select([['Select Category', '']] + Category.all.map { |item| [item.name, item.id] }, @application.category_id),
              {},
              { class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-50" } %>
          <% if @application.errors[:category_id].any? %>
            <p class="text-sm text-red-500 mt-1"><%= @application.errors[:category_id].first %></p>
          <% end %>
        </div>

        <!-- Form Actions -->
        <div class="flex justify-end space-x-3">
          <%= link_to admin_applications_path, class: "btn-ghost" do %>
            Cancel
          <% end %>
          <%= form.submit "Create Application", class: "btn-primary" %>
        </div>
      <% end %>
    </div>
  </div>
</div>